<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多玩家图片文字游戏</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f5f5f5;
            position: relative;
        }
        #game {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        #center-box {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 2px dashed black;
            padding: 20px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: transform 0.5s;
            cursor: pointer;
            font-size: 2em; /* 调整文字大小 */
        }
        #center-box img {
            width: 30vw; /* 调整图片大小 */
            height: auto;
        }
        #arrow {
            position: absolute;
            bottom: -40px;
            font-size: 50px; /* 调整箭头大小 */
        }
        .corner-button {
            position: absolute;
            width: 10vw;
            height: 5vh;
            background-color: grey;
            color: white;
            border: none;
            border-radius: 5px;
        }
        .corner-button.active {
            background-color: red;
        }
        .player-label {
            position: absolute;
            font-size: 2vh;
            color: black;
        }
        .score-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px; /* 调整分数容器的间距 */
        }
        .score-button {
            width: 40px;
            height: 40px;
            margin: 0 5px;
            border: none;
            background-color: #4CAF50;
            color: white;
            font-size: 20px;
            line-height: 40px;
            border-radius: 50%;
            cursor: pointer;
        }
        .score {
            font-size: 20px;
            margin: 0 5px;
        }
        #player1 {
            top: 7vh;
            left: 7vw;
            transform: rotate(-183deg);
        }
        #label1 {
            top: 6vw;
            left: 3vw;
            transform: rotate(-20deg);
        }
        #player2 {
            top: 7vh;
            right: 7vw;
            transform: rotate(183deg);
        }
        #label2 {
            top: 6vw;
            right: 3vw;
            transform: rotate(20deg);
        }
        #player3 {
            bottom: 9vh;
            right: 8vw;
            transform: rotate(-2deg);
        }
        #label3 {
            bottom: 6vw;
            right: 3vw;
            transform: rotate(-20deg);
        }
        #player4 {
            bottom: 9vh;
            left: 8vw;
            transform: rotate(-2deg);
        }
        #label4 {
            bottom: 6vw;
            left: 3vw;
            transform: rotate(20deg);
        }
    </style>
</head>
<body>

<div id="game">
    <div id="center-box">
        <img id="item-img" src="" alt="图片">
        <p id="item-text">中文字</p>
    </div>
    <div id="label1" class="player-label">
        <div class="score-container">
            <button class="score-button" onclick="updateScore(1, 1)">+</button>
            <span id="score1" class="score">0</span>
            <button class="score-button" onclick="updateScore(1, -1)">-</button>
        </div>
        <button id="player1" class="corner-button active">开始</button>
    </div>

    <div id="label2" class="player-label">
        <div class="score-container">
            <button class="score-button" onclick="updateScore(2, 1)">+</button>
            <span id="score2" class="score">0</span>
            <button class="score-button" onclick="updateScore(2, -1)">-</button>
        </div>
        <button id="player2" class="corner-button" disabled>开始</button>
    </div>

    <div id="label3" class="player-label">
        <div class="score-container">
            <button class="score-button" onclick="updateScore(3, 1)">+</button>
            <span id="score3" class="score">0</span>
            <button class="score-button" onclick="updateScore(3, -1)">-</button>
        </div>
        <button id="player3" class="corner-button" disabled>开始</button>
    </div>

    <div id="label4" class="player-label">
        <div class="score-container">
            <button class="score-button" onclick="updateScore(4, 1)">+</button>
            <span id="score4" class="score">0</span>
            <button class="score-button" onclick="updateScore(4, -1)">-</button>
        </div>
        <button id="player4" class="corner-button" disabled>开始</button>
    </div>
</div>

<script>
    const data = [
        { "english": "apple", "chinese": "苹果", "picture": "./apple.jpg" },
        { "english": "pear", "chinese": "雪梨", "picture": "./pear.jpg" },
        { "english": "fish", "chinese": "鱼1", "picture": "./fish.jpg" },
        { "english": "fish", "chinese": "鱼2", "picture": "./fish.jpg" },
        { "english": "fish", "chinese": "鱼3", "picture": "./fish.jpg" },
        { "english": "fish", "chinese": "鱼4", "picture": "./fish.jpg" }
    ];

    let usedIndexes = new Set();
    let currentIndex = 0;
    let currentPlayer = 1;
    let interval;
    let showingChinese = true;

    function startGame(playerId) {
        document.getElementById(`player${playerId}`).innerText = "暂停";
        interval = setInterval(() => {
            currentIndex = getRandomIndex();
            document.getElementById("item-img").src = data[currentIndex].picture;
            document.getElementById("item-text").innerText = data[currentIndex].chinese;
        }, 100);
        rotateCenterBox(playerId);
        updateButtonStyles(playerId);
    }

    function pauseGame(playerId) {
        clearInterval(interval);
        document.getElementById(`player${playerId}`).innerText = "下一个";
        usedIndexes.add(currentIndex);
    }

    function nextPlayer(playerId) {
        document.getElementById(`player${playerId}`).disabled = true;
        document.getElementById(`player${playerId}`).innerText = "开始";
        currentPlayer = (currentPlayer % 4) + 1;
        document.getElementById(`player${currentPlayer}`).disabled = false;
        rotateCenterBox(currentPlayer);
        updateButtonStyles(currentPlayer);
    }

    function getRandomIndex() {
        if (usedIndexes.size >= data.length) {
            alert("所有题目都已经用完！");
            return currentIndex;
        }
        let index;
        do {
            index = Math.floor(Math.random() * data.length);
        } while (usedIndexes.has(index));
        return index;
    }

    function rotateCenterBox(playerId) {
        const centerBox = document.getElementById("center-box");
        switch (playerId) {
            case 1:
                centerBox.style.transform = "translate(-50%, -50%) rotate(155deg)";
                break;
            case 2:
                centerBox.style.transform = "translate(-50%, -50%) rotate(209deg)";
                break;
            case 3:
                centerBox.style.transform = "translate(-50%, -50%) rotate(337deg)";
                break;
            case 4:
                centerBox.style.transform = "translate(-50%, -50%) rotate(383deg)";
                break;
        }
    }

    function updateButtonStyles(activePlayerId) {
        for (let i = 1; i <= 4; i++) {
            const button = document.getElementById(`player${i}`);
            if (i === activePlayerId) {
                button.classList.add("active");
            } else {
                button.classList.remove("active");
            }
        }
    }

    function updateScore(playerId, change) {
        const scoreSpan = document.getElementById(`score${playerId}`);
        let score = parseInt(scoreSpan.innerText);
        score += change;
        scoreSpan.innerText = score;
    }

    document.getElementById("center-box").addEventListener("click", () => {
        showingChinese = !showingChinese;
        document.getElementById("item-text").innerText = showingChinese ? data[currentIndex].chinese : data[currentIndex].english;
    });

    document.getElementById("player1").addEventListener("click", function () {
        if (this.innerText === "开始") {
            startGame(1);
        } else if (this.innerText === "暂停") {
            pauseGame(1);
        } else {
            nextPlayer(1);
        }
    });

    document.getElementById("player2").addEventListener("click", function () {
        if (this.innerText === "开始") {
            startGame(2);
        } else if (this.innerText === "暂停") {
            pauseGame(2);
        } else {
            nextPlayer(2);
        }
    });

    document.getElementById("player3").addEventListener("click", function () {
        if (this.innerText === "开始") {
            startGame(3);
        } else if (this.innerText === "暂停") {
            pauseGame(3);
        } else {
            nextPlayer(3);
        }
    });

    document.getElementById("player4").addEventListener("click", function () {
        if (this.innerText === "开始") {
            startGame(4);
        } else if (this.innerText === "暂停") {
            pauseGame(4);
        } else {
            nextPlayer(4);
        }
    });
</script>

</body>
</html>
